<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Previous meta tags and scripts remain the same -->
    <style>
        /* Previous styles remain the same */
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 0 5px;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background: #0056b3;
        }

        /* Add new success state for buttons */
        button.success {
            background: #28a745 !important; /* Green color for success state */
        }

        /* Rest of your previous styles remain the same */
    </style>
</head>
<body>
    <!-- Previous HTML remains the same until the script section -->
    <script>
        function showButtonFeedback(button, message) {
            const originalText = button.textContent;
            const originalClass = button.className;
            button.textContent = message;
            button.classList.add('success');
            button.disabled = true;
            setTimeout(() => {
                button.textContent = originalText;
                button.className = originalClass;
                button.disabled = false;
            }, 2000);
        }

        window.onload = function() {
            const editor = document.getElementById('editor');
            const preview = document.getElementById('preview');
            const titleInput = document.getElementById('title');
            const subtitleInput = document.getElementById('subtitle');
            const errorMessage = document.getElementById('errorMessage');

            // Previous functions remain the same until copyImage

            window.copyImage = function() {
                const preview = document.getElementById('preview');
                // Force MathJax to re-render before capturing
                MathJax.typesetClear([preview]);
                MathJax.typesetPromise([preview]).then(() => {
                    html2canvas(preview, {
                        scale: 2,
                        useCORS: true,
                        allowTaint: true,
                        logging: false,
                        onclone: function(clonedDoc) {
                            // Ensure MathJax has fully rendered in the clone
                            const clonedPreview = clonedDoc.getElementById('preview');
                            return MathJax.typesetPromise([clonedPreview]);
                        }
                    }).then(canvas => {
                        canvas.toBlob(blob => {
                            navigator.clipboard.write([
                                new ClipboardItem({ 'image/png': blob })
                            ]).then(() => {
                                showButtonFeedback(document.getElementById('copyImageBtn'), 'Copied!');
                            }).catch(err => console.error('Error copying image:', err));
                        });
                    });
                });
            };

            // Initialize the editor
            renderMarkdown();
        };
    </script>
</body>
</html>
